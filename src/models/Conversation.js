/**
 * Models related to conversations and messages in the Chatsidian plugin.
 * Defines the core data structures for representing chat interactions,
 * including conversations, messages, roles, and tool usage.
 * Also provides utility functions for creating and managing these structures.
 */
/**
 * Enum for message roles in a conversation, indicating the sender.
 */
export var MessageRole;
(function (MessageRole) {
    MessageRole["User"] = "user";
    MessageRole["Assistant"] = "assistant";
    MessageRole["System"] = "system";
})(MessageRole || (MessageRole = {}));
/**
 * Provides utility functions for creating and managing Conversation and Message objects.
 */
export class ConversationUtils {
    /**
     * Creates a new Conversation object with default values and generated IDs.
     * @param title Optional title for the new conversation. Defaults to a timestamped title.
     * @returns A new Conversation object.
     */
    static createNew(title) {
        const id = this.generateId();
        const now = Date.now();
        return {
            id,
            title: title || `New Conversation (${new Date(now).toLocaleString()})`,
            createdAt: now,
            modifiedAt: now,
            messages: [],
        };
    }
    /**
     * Creates a new Message object with a generated ID and current timestamp.
     * @param role The role of the message sender (User, Assistant, System).
     * @param content The textual content of the message.
     * @returns A new Message object.
     */
    static createMessage(role, content) {
        const id = this.generateId();
        return {
            id,
            role,
            content,
            timestamp: Date.now(),
        };
    }
    /**
     * Adds a new message to a conversation immutably.
     * Updates the conversation's modifiedAt timestamp.
     * @param conversation The conversation to add the message to.
     * @param message The message to add.
     * @returns A new Conversation object with the added message.
     */
    static addMessage(conversation, message) {
        return {
            ...conversation,
            messages: [...conversation.messages, message],
            modifiedAt: Date.now(),
        };
    }
    /**
     * Generates a unique ID combining timestamp and random string.
     * @returns A unique string identifier.
     */
    static generateId() {
        return Date.now().toString(36) + Math.random().toString(36).substring(2, 9);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ29udmVyc2F0aW9uLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiQ29udmVyc2F0aW9uLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7OztHQUtHO0FBa0NIOztHQUVHO0FBQ0gsTUFBTSxDQUFOLElBQVksV0FJWDtBQUpELFdBQVksV0FBVztJQUNyQiw0QkFBYSxDQUFBO0lBQ2Isc0NBQXVCLENBQUE7SUFDdkIsZ0NBQWlCLENBQUE7QUFDbkIsQ0FBQyxFQUpXLFdBQVcsS0FBWCxXQUFXLFFBSXRCO0FBMkREOztHQUVHO0FBQ0gsTUFBTSxPQUFPLGlCQUFpQjtJQUM1Qjs7OztPQUlHO0lBQ0gsTUFBTSxDQUFDLFNBQVMsQ0FBQyxLQUFjO1FBQzdCLE1BQU0sRUFBRSxHQUFHLElBQUksQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUM3QixNQUFNLEdBQUcsR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7UUFFdkIsT0FBTztZQUNMLEVBQUU7WUFDRixLQUFLLEVBQUUsS0FBSyxJQUFJLHFCQUFxQixJQUFJLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxjQUFjLEVBQUUsR0FBRztZQUN0RSxTQUFTLEVBQUUsR0FBRztZQUNkLFVBQVUsRUFBRSxHQUFHO1lBQ2YsUUFBUSxFQUFFLEVBQUU7U0FDYixDQUFDO0lBQ0osQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0gsTUFBTSxDQUFDLGFBQWEsQ0FBQyxJQUFpQixFQUFFLE9BQWU7UUFDckQsTUFBTSxFQUFFLEdBQUcsSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBRTdCLE9BQU87WUFDTCxFQUFFO1lBQ0YsSUFBSTtZQUNKLE9BQU87WUFDUCxTQUFTLEVBQUUsSUFBSSxDQUFDLEdBQUcsRUFBRTtTQUN0QixDQUFDO0lBQ0osQ0FBQztJQUVEOzs7Ozs7T0FNRztJQUNILE1BQU0sQ0FBQyxVQUFVLENBQUMsWUFBMEIsRUFBRSxPQUFnQjtRQUM1RCxPQUFPO1lBQ0wsR0FBRyxZQUFZO1lBQ2YsUUFBUSxFQUFFLENBQUMsR0FBRyxZQUFZLENBQUMsUUFBUSxFQUFFLE9BQU8sQ0FBQztZQUM3QyxVQUFVLEVBQUUsSUFBSSxDQUFDLEdBQUcsRUFBRTtTQUN2QixDQUFDO0lBQ0osQ0FBQztJQUVEOzs7T0FHRztJQUNLLE1BQU0sQ0FBQyxVQUFVO1FBQ3ZCLE9BQU8sSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDOUUsQ0FBQztDQUNGIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIE1vZGVscyByZWxhdGVkIHRvIGNvbnZlcnNhdGlvbnMgYW5kIG1lc3NhZ2VzIGluIHRoZSBDaGF0c2lkaWFuIHBsdWdpbi5cclxuICogRGVmaW5lcyB0aGUgY29yZSBkYXRhIHN0cnVjdHVyZXMgZm9yIHJlcHJlc2VudGluZyBjaGF0IGludGVyYWN0aW9ucyxcclxuICogaW5jbHVkaW5nIGNvbnZlcnNhdGlvbnMsIG1lc3NhZ2VzLCByb2xlcywgYW5kIHRvb2wgdXNhZ2UuXHJcbiAqIEFsc28gcHJvdmlkZXMgdXRpbGl0eSBmdW5jdGlvbnMgZm9yIGNyZWF0aW5nIGFuZCBtYW5hZ2luZyB0aGVzZSBzdHJ1Y3R1cmVzLlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5cclxuLyoqXHJcbiAqIFJlcHJlc2VudHMgYSBjb252ZXJzYXRpb24gYmV0d2VlbiBhIHVzZXIgYW5kIGFuIEFJIGFzc2lzdGFudC5cclxuICogVGhpcyBpcyB0aGUgbWFpbiBjb250YWluZXIgZm9yIGEgY2hhdCBzZXNzaW9uLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBDb252ZXJzYXRpb24ge1xyXG4gIC8qKiBVbmlxdWUgaWRlbnRpZmllciBmb3IgdGhlIGNvbnZlcnNhdGlvbiAqL1xyXG4gIGlkOiBzdHJpbmc7XHJcblxyXG4gIC8qKiBEaXNwbGF5IHRpdGxlIGZvciB0aGUgY29udmVyc2F0aW9uICovXHJcbiAgdGl0bGU6IHN0cmluZztcclxuXHJcbiAgLyoqIFRpbWVzdGFtcCB3aGVuIHRoZSBjb252ZXJzYXRpb24gd2FzIGNyZWF0ZWQgKFVuaXggZXBvY2ggbWlsbGlzZWNvbmRzKSAqL1xyXG4gIGNyZWF0ZWRBdDogbnVtYmVyO1xyXG5cclxuICAvKiogVGltZXN0YW1wIHdoZW4gdGhlIGNvbnZlcnNhdGlvbiB3YXMgbGFzdCBtb2RpZmllZCAoVW5peCBlcG9jaCBtaWxsaXNlY29uZHMpICovXHJcbiAgbW9kaWZpZWRBdDogbnVtYmVyO1xyXG5cclxuICAvKiogQXJyYXkgb2YgbWVzc2FnZXMgaW4gdGhlIGNvbnZlcnNhdGlvbiwgb3JkZXJlZCBjaHJvbm9sb2dpY2FsbHkgKi9cclxuICBtZXNzYWdlczogTWVzc2FnZVtdO1xyXG5cclxuICAvKiogT3B0aW9uYWwgbWV0YWRhdGEgZm9yIHRoZSBjb252ZXJzYXRpb24gKGUuZy4sIHRhZ3MsIGNvbnRleHQsIGFzc29jaWF0ZWQgbm90ZXMpICovXHJcbiAgbWV0YWRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xyXG5cclxuICAvKiogT3B0aW9uYWwgcmVmZXJlbmNlIHRvIHRoZSBPYnNpZGlhbiBmaWxlIHdoZXJlIHRoaXMgY29udmVyc2F0aW9uIGlzIHN0b3JlZCAqL1xyXG4gIGZpbGU/OiBURmlsZTtcclxuXHJcbiAgLyoqIE9wdGlvbmFsIHBhdGggd2l0aGluIHRoZSB2YXVsdCB3aGVyZSB0aGlzIGNvbnZlcnNhdGlvbiBpcyBzdG9yZWQgKi9cclxuICBwYXRoPzogc3RyaW5nO1xyXG59XHJcblxyXG4vKipcclxuICogRW51bSBmb3IgbWVzc2FnZSByb2xlcyBpbiBhIGNvbnZlcnNhdGlvbiwgaW5kaWNhdGluZyB0aGUgc2VuZGVyLlxyXG4gKi9cclxuZXhwb3J0IGVudW0gTWVzc2FnZVJvbGUge1xyXG4gIFVzZXIgPSAndXNlcicsXHJcbiAgQXNzaXN0YW50ID0gJ2Fzc2lzdGFudCcsXHJcbiAgU3lzdGVtID0gJ3N5c3RlbScsXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZXByZXNlbnRzIGEgc2luZ2xlIG1lc3NhZ2Ugd2l0aGluIGEgY29udmVyc2F0aW9uLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBNZXNzYWdlIHtcclxuICAvKiogVW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSBtZXNzYWdlICovXHJcbiAgaWQ6IHN0cmluZztcclxuXHJcbiAgLyoqIFRoZSByb2xlIG9mIHRoZSBtZXNzYWdlIHNlbmRlciAqL1xyXG4gIHJvbGU6IE1lc3NhZ2VSb2xlO1xyXG5cclxuICAvKiogVGhlIHRleHR1YWwgY29udGVudCBvZiB0aGUgbWVzc2FnZSAqL1xyXG4gIGNvbnRlbnQ6IHN0cmluZztcclxuXHJcbiAgLyoqIFRpbWVzdGFtcCB3aGVuIHRoZSBtZXNzYWdlIHdhcyBzZW50IChVbml4IGVwb2NoIG1pbGxpc2Vjb25kcykgKi9cclxuICB0aW1lc3RhbXA6IG51bWJlcjtcclxuXHJcbiAgLyoqIE9wdGlvbmFsIGFycmF5IG9mIHRvb2wgY2FsbHMgbWFkZSBieSB0aGUgYXNzaXN0YW50IGluIHRoaXMgbWVzc2FnZSAqL1xyXG4gIHRvb2xDYWxscz86IFRvb2xDYWxsW107XHJcblxyXG4gIC8qKiBPcHRpb25hbCBhcnJheSBvZiByZXN1bHRzIGNvcnJlc3BvbmRpbmcgdG8gdG9vbCBjYWxscyAqL1xyXG4gIHRvb2xSZXN1bHRzPzogVG9vbFJlc3VsdFtdO1xyXG59XHJcblxyXG4vKipcclxuICogUmVwcmVzZW50cyBhIHRvb2wgY2FsbCByZXF1ZXN0ZWQgYnkgdGhlIEFJIGFzc2lzdGFudC5cclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgVG9vbENhbGwge1xyXG4gIC8qKiBVbmlxdWUgaWRlbnRpZmllciBmb3IgdGhlIHRvb2wgY2FsbCBpbnN0YW5jZSAqL1xyXG4gIGlkOiBzdHJpbmc7XHJcblxyXG4gIC8qKiBUaGUgbmFtZSBvZiB0aGUgdG9vbCBiZWluZyBjYWxsZWQgKGUuZy4sICdOb3RlTWFuYWdlci5jcmVhdGVOb3RlJykgKi9cclxuICBuYW1lOiBzdHJpbmc7XHJcblxyXG4gIC8qKiBUaGUgYXJndW1lbnRzIHBhc3NlZCB0byB0aGUgdG9vbCwgdHlwaWNhbGx5IGFzIGEgSlNPTiBvYmplY3QgKi9cclxuICBhcmd1bWVudHM6IGFueTtcclxuXHJcbiAgLyoqIFRoZSBjdXJyZW50IHN0YXR1cyBvZiB0aGUgdG9vbCBjYWxsICovXHJcbiAgc3RhdHVzOiAncGVuZGluZycgfCAnc3VjY2VzcycgfCAnZXJyb3InO1xyXG59XHJcblxyXG4vKipcclxuICogUmVwcmVzZW50cyB0aGUgcmVzdWx0IHJldHVybmVkIGZyb20gZXhlY3V0aW5nIGEgdG9vbCBjYWxsLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBUb29sUmVzdWx0IHtcclxuICAvKiogVW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSByZXN1bHQgKi9cclxuICBpZDogc3RyaW5nO1xyXG5cclxuICAvKiogVGhlIElEIG9mIHRoZSB0b29sIGNhbGwgdGhpcyByZXN1bHQgY29ycmVzcG9uZHMgdG8gKi9cclxuICB0b29sQ2FsbElkOiBzdHJpbmc7XHJcblxyXG4gIC8qKiBUaGUgY29udGVudCByZXR1cm5lZCBieSB0aGUgdG9vbCwgY2FuIGJlIGFueSBzZXJpYWxpemFibGUgdHlwZSAqL1xyXG4gIGNvbnRlbnQ6IGFueTtcclxuXHJcbiAgLyoqIE9wdGlvbmFsIGVycm9yIG1lc3NhZ2UgaWYgdGhlIHRvb2wgY2FsbCBmYWlsZWQgKi9cclxuICBlcnJvcj86IHN0cmluZztcclxufVxyXG5cclxuLyoqXHJcbiAqIFByb3ZpZGVzIHV0aWxpdHkgZnVuY3Rpb25zIGZvciBjcmVhdGluZyBhbmQgbWFuYWdpbmcgQ29udmVyc2F0aW9uIGFuZCBNZXNzYWdlIG9iamVjdHMuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgQ29udmVyc2F0aW9uVXRpbHMge1xyXG4gIC8qKlxyXG4gICAqIENyZWF0ZXMgYSBuZXcgQ29udmVyc2F0aW9uIG9iamVjdCB3aXRoIGRlZmF1bHQgdmFsdWVzIGFuZCBnZW5lcmF0ZWQgSURzLlxyXG4gICAqIEBwYXJhbSB0aXRsZSBPcHRpb25hbCB0aXRsZSBmb3IgdGhlIG5ldyBjb252ZXJzYXRpb24uIERlZmF1bHRzIHRvIGEgdGltZXN0YW1wZWQgdGl0bGUuXHJcbiAgICogQHJldHVybnMgQSBuZXcgQ29udmVyc2F0aW9uIG9iamVjdC5cclxuICAgKi9cclxuICBzdGF0aWMgY3JlYXRlTmV3KHRpdGxlPzogc3RyaW5nKTogQ29udmVyc2F0aW9uIHtcclxuICAgIGNvbnN0IGlkID0gdGhpcy5nZW5lcmF0ZUlkKCk7XHJcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlkLFxyXG4gICAgICB0aXRsZTogdGl0bGUgfHwgYE5ldyBDb252ZXJzYXRpb24gKCR7bmV3IERhdGUobm93KS50b0xvY2FsZVN0cmluZygpfSlgLFxyXG4gICAgICBjcmVhdGVkQXQ6IG5vdyxcclxuICAgICAgbW9kaWZpZWRBdDogbm93LFxyXG4gICAgICBtZXNzYWdlczogW10sXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ3JlYXRlcyBhIG5ldyBNZXNzYWdlIG9iamVjdCB3aXRoIGEgZ2VuZXJhdGVkIElEIGFuZCBjdXJyZW50IHRpbWVzdGFtcC5cclxuICAgKiBAcGFyYW0gcm9sZSBUaGUgcm9sZSBvZiB0aGUgbWVzc2FnZSBzZW5kZXIgKFVzZXIsIEFzc2lzdGFudCwgU3lzdGVtKS5cclxuICAgKiBAcGFyYW0gY29udGVudCBUaGUgdGV4dHVhbCBjb250ZW50IG9mIHRoZSBtZXNzYWdlLlxyXG4gICAqIEByZXR1cm5zIEEgbmV3IE1lc3NhZ2Ugb2JqZWN0LlxyXG4gICAqL1xyXG4gIHN0YXRpYyBjcmVhdGVNZXNzYWdlKHJvbGU6IE1lc3NhZ2VSb2xlLCBjb250ZW50OiBzdHJpbmcpOiBNZXNzYWdlIHtcclxuICAgIGNvbnN0IGlkID0gdGhpcy5nZW5lcmF0ZUlkKCk7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaWQsXHJcbiAgICAgIHJvbGUsXHJcbiAgICAgIGNvbnRlbnQsXHJcbiAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBBZGRzIGEgbmV3IG1lc3NhZ2UgdG8gYSBjb252ZXJzYXRpb24gaW1tdXRhYmx5LlxyXG4gICAqIFVwZGF0ZXMgdGhlIGNvbnZlcnNhdGlvbidzIG1vZGlmaWVkQXQgdGltZXN0YW1wLlxyXG4gICAqIEBwYXJhbSBjb252ZXJzYXRpb24gVGhlIGNvbnZlcnNhdGlvbiB0byBhZGQgdGhlIG1lc3NhZ2UgdG8uXHJcbiAgICogQHBhcmFtIG1lc3NhZ2UgVGhlIG1lc3NhZ2UgdG8gYWRkLlxyXG4gICAqIEByZXR1cm5zIEEgbmV3IENvbnZlcnNhdGlvbiBvYmplY3Qgd2l0aCB0aGUgYWRkZWQgbWVzc2FnZS5cclxuICAgKi9cclxuICBzdGF0aWMgYWRkTWVzc2FnZShjb252ZXJzYXRpb246IENvbnZlcnNhdGlvbiwgbWVzc2FnZTogTWVzc2FnZSk6IENvbnZlcnNhdGlvbiB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAuLi5jb252ZXJzYXRpb24sXHJcbiAgICAgIG1lc3NhZ2VzOiBbLi4uY29udmVyc2F0aW9uLm1lc3NhZ2VzLCBtZXNzYWdlXSxcclxuICAgICAgbW9kaWZpZWRBdDogRGF0ZS5ub3coKSxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZW5lcmF0ZXMgYSB1bmlxdWUgSUQgY29tYmluaW5nIHRpbWVzdGFtcCBhbmQgcmFuZG9tIHN0cmluZy5cclxuICAgKiBAcmV0dXJucyBBIHVuaXF1ZSBzdHJpbmcgaWRlbnRpZmllci5cclxuICAgKi9cclxuICBwcml2YXRlIHN0YXRpYyBnZW5lcmF0ZUlkKCk6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gRGF0ZS5ub3coKS50b1N0cmluZygzNikgKyBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHJpbmcoMiwgOSk7XHJcbiAgfVxyXG59XHJcbiJdfQ==